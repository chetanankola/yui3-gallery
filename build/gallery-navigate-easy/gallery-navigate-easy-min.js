YUI.add("gallery-navigate-easy",function(c){var g="down:39+shift",e="down:37+shift",b="down:68+shift",i="down:69+shift",d=true,k=false,f="transhighlight",j="containerhighlight",h=true,a=function(l){a.superclass.constructor.apply(this,arguments);};a.NAME="Navigation";a.ATTRS={activeRegistryIndex:{value:null},registry:[],debug:{value:null}};c.extend(a,c.Base,{container:{node:null,containerId:null,children:[],childIndexInFocus:-1,activeLink:null,isHorizontal:false},initializer:function(l){var m=this;this.reorderRegistryByRank();this.activateContainerNavigation();this.makeNextContainerNavigable();c.one("body").on("key",function(n){m.disableAllNavigation();},b);c.one("body").on("key",function(n){m.enableAllNavigation();},i);},enableAllNavigation:function(){if(this.activateContainerNavigation()){this.makeNextContainerNavigable(d);}},disableAllNavigation:function(){this.deactivateRegisteredContainer();this.deactivateContainerNavigation();},register:function(m){var o=m||{},n=o.node,l=this.get("registry");if(c.one(n)){l[l.length]=o;this.reorderRegistryByRank();}else{}},deRegister:function(n){var q=n||{},p=q.node,l=this.get("registry"),o=c.one(p),m=null;if(o){m=this.isNodeInRegistry(p);if(m!==null){l.splice(m,1);this.reorderRegistryByRank();}else{}}else{}},isNodeInRegistry:function(o){var n=0,m=this.get("registry"),l=m.length;for(n=0;n<l;n++){if(o===m[n].node){return n;}}return null;},reorderRegistryByRank:function(){var m=this.get("registry"),l=m.length,p=[],q,n,o;for(o=0;o<l;o++){p[o]=null;if(m[o].rank===undefined){m[o].rank=null;}}for(o=0;o<l;o++){q=m[o].rank;if(q&&q>0&&q<=l){if(p[q-1]!==null){m[o].rank=null;}else{p[q-1]=m[o];}}}n=0;for(o=0;o<l;o++){q=m[o].rank;if(q===null||q<=0||q>l){while(p[n]!==null){n++;}p[n]=m[o];p[n].rank=n+1;}}this.set("registry",p);},activateContainerNavigation:function(){var l=this;if(c.ContainerSubscr){return false;}else{c.ContainerSubscr={};}c.ContainerSubscr.next=c.one("body").on("key",function(m){l.makeNextContainerNavigable(d);},g);c.ContainerSubscr.prev=c.one("body").on("key",function(m){l.makeNextContainerNavigable(k);},e);return true;},deactivateContainerNavigation:function(){var m,l=c.ContainerSubscr;if(l){for(m in l){if(l.hasOwnProperty(m)){l[m].detach();}}delete c.ContainerSubscr;}else{}this.set("activeRegistryIndex",null);},makeNextContainerNavigable:function(m){var l=this.get("registry"),n,o,p=false;if(l.length>0){n=this.getNextRegistryIndex(m);if(n!==null&&l[n]){o=c.one(l[n].node);if(o){p=l[n].isHorizontal||false;this.deactivateRegisteredContainer();this.registerContainer(o,(n+1),p);this.initiateNavigation();}else{this.deactivateRegisteredContainer();}}}else{}},getNextRegistryIndex:function(m){var l=this.get("registry"),o,p=null,n=0;if(l&&l.length>0){for(n=0;n<l.length;n++){o=l.length;p=this.get("activeRegistryIndex");if(p===null){p=0;}else{p=m?(p+1):(p-1);if(p>=o){p=0;}if(p<0){p=o-1;}}this.set("activeRegistryIndex",p);if(c.one(l[p].node)){return p;}else{}}return p;}return null;},registerContainer:function(l,n,m){if(l){this.updateChildren(l,n,m);}else{}},updateChildren:function(o,q,p){var n=o.all("> *"),m=[],l=this.container;n.each(function(t,r,s){m[r]=t;});l.isHorizontal=p||false;l.rank=q;l.node=o;l.children=m;l.containerId=o.generateID();},initiateNavigation:function(){this.activateRegisteredContainer();},deactivateRegisteredContainer:function(){this.killAllChildNavigationSubscription();this.removeHighlightonContainer();this.removeHighlightonCurrentChild();this.resetContainer();},removeHighlightonContainer:function(){var l=this.container;if(l&&l.node){l.node.removeClass(j);}},highlightContainer:function(){var l=this.container;if(l&&l.node){l.node.addClass(j);}},removeHighlightonCurrentChild:function(){var l=this.container,m=l.childIndexInFocus;if(m!==null&&m!==-1){l.children[m].removeClass(f);}},resetRegistryIndex:function(){this.set("activeRegistryIndex",null);},resetContainer:function(){this.container={rank:null,node:null,containerId:null,children:[],childIndexInFocus:-1,isHorizontal:false};this.wasLastChild=false;},killAllChildNavigationSubscription:function(){if(c.BodySubscr){this.detachAllChildSubscriptions();}},splash:function(q,r){var o='<h1 style="font-size:3em;color:#444;position:fixed;-webkit-transform: rotate(-10deg);" id="_splash">'+q+"</h1>",p,m,n,l=r||[0,0];p=c.one("#_splash");m=c.one("body");if(p){p.remove();}n=c.DOM.create(o);m.append(n);p=c.one("#_splash").setXY(l).addClass("cramDownOpacity");},activateRegisteredContainer:function(){var l=this.container,m;if(l&&l.node){this.highlightContainer();if(this.get("debug")){m=[200,200];this.splash("Rank:"+l.rank+"<br>id:"+l.node.generateID()+"<br>isHorizontal:"+l.isHorizontal,m);}}c.BodySubscr={};if(l.isHorizontal){c.BodySubscr.keyright=c.one("body").on("right",c.bind(this.onMyKeyDown,this));c.BodySubscr.keyleft=c.one("body").on("left",c.bind(this.onMyKeyUp,this));c.one("body").simulate("keydown",{keyCode:39});}else{c.BodySubscr.keydown=c.one("body").on("down",c.bind(this.onMyKeyDown,this));c.BodySubscr.keyup=c.one("body").on("up",c.bind(this.onMyKeyUp,this));c.one("body").simulate("keydown",{keyCode:40});}},detachAllChildSubscriptions:function(){var l=c.BodySubscr,m;if(l){for(m in l){if(l.hasOwnProperty(m)){l[m].detach();}}delete c.BodySubscr;}},onMyKeyDown:function(m){var l=this.container,o,n;this.wasLastChild=false;if(l){m.preventDefault();o=l.childIndexInFocus;n=this.getNextIndex(o);l.childIndexInFocus=n;this.bringChildtoFocus(l.children[n]);}else{}},onMyKeyUp:function(m){var l=this.container,o,n;if(l){m.preventDefault();o=l.childIndexInFocus;n=this.getPreviousIndex(o);this.bringChildtoFocus(l.children[n]);l.childIndexInFocus=n;}else{}},destructor:function(){if(this.anim){delete this.anim;}},getNextIndex:function(n){var l=this.container,m=l.children.length;if(n!=-1){l.children[n].removeClass(f);}if(n===m-1){n=-1;this.wasLastChild=true;}else{this.wasLastChild=false;}n++;return n;},getPreviousIndex:function(n){var l=this.container,m=l.children.length;if(n>=0){l.children[n].removeClass(f);}if(n===0){n=m;
}n--;if(n<0){n=0;}return n;},_scroll:function(l){if(!h){window.scroll(0,l);}else{if(this.anim){delete this.anim;}this.anim=new c.Anim({node:"window",from:{scroll:[c.DOM.docScrollX(),c.DOM.docScrollY()]},to:{scroll:[c.DOM.docScrollX(),l]},duration:0.2,easing:c.Easing.easeNone}).run();}},scrollToCenter:function(n){var p=n.getY(),l=n.get("clientHeight"),r=l/2,m=n.get("winHeight"),o=m/2,q=0;if(l>m){r=0;}if(p>o){if(this.anim&&this.anim.get("running")){this.anim.pause();}q=p-o+r;}else{}if(c.DOM.inViewportRegion(c.Node.getDOMNode(n),true,null)){return null;}else{n.scrollIntoView();return q;}return q;},bringChildtoFocus:function(o){var m=o.all("a"),p=[],n,l={};o.addClass(f).focus();if(this.activeLink){this.activeLink.blur();}m.each(function(s,q,r){p[q]=s;});if(p[0]){p[0].focus();this.activeLink=p[0];}if(this.anim&&this.anim.get("running")){this.anim.pause();}n=this.scrollToCenter(o);if(n){l={childsY:o.getY(),childHeight:o.get("clientHeight"),winHeight:o.get("winHeight"),currentScrollY:c.DOM.docScrollY(),amountgoingtoScroll:n};this._scroll(n,o.getY);}}});c.Nav=a;},"@VERSION@",{requires:["node","event","event-key","gallery-event-nav-keys","base","anim","node-event-simulate"],skinnable:false});